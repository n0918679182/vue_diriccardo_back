import{d as b,a as l,p as f,_ as O,m as k,b as I,o as i,c as d,e as n,F as p,f as m,t as g,l as S,i as v,j as T}from"./index-eec74d39.js";const u=b("kitchenStore",{state:()=>({newOrderLists:[],noKitchenDeleteTemp:!0}),actions:{getKitchenOrders(){l.get("http://localhost:3000/kitchenOrders").then(e=>{this.orderLists=e.data.sort((t,s)=>t.id>s.id),this.newOrderLists=this.changeOrder(this.orderLists)})},changeOrder(e){const{allProducts:t}=f();let s=[];return e.forEach(r=>{let a=[];r.orders.forEach(c=>{t.forEach(o=>{o.id===c&&a.push(o)}),r.newOrders=a}),s.push(r)}),s},lineOrder(e,t){document.getElementById(e+"_order_"+t).classList.toggle("delLine")},haveDeleteTemp(){localStorage.getItem("kitchenDeleteTemp")?this.noKitchenDeleteTemp=!1:this.noKitchenDeleteTemp=!0},deleteFromKitchen(e){let t=[];localStorage.getItem("kitchenDeleteTemp")&&(t=JSON.parse(localStorage.getItem("kitchenDeleteTemp"))),t.length>=10&&t.splice(0,1),t.push(e),localStorage.setItem("kitchenDeleteTemp",JSON.stringify(t)),l.delete("http://localhost:3000/kitchenOrders/"+e.id).catch(s=>console.log(s.response.data.message))},async undo(){const e=JSON.parse(localStorage.getItem("kitchenDeleteTemp")),t={id:e[e.length-1].id,orders:e[e.length-1].orders,tableId:e[e.length-1].tableId};await l.get("http://localhost:3000/kitchenOrders").then(s=>{let r=!1;return s.data.forEach(a=>{a.id==t.id&&(r=!0,a.orders.forEach(c=>{t.orders.push(c)}))}),r?l.patch("http://localhost:3000/kitchenOrders/"+t.id,t).catch(a=>console.log(a.response.data.message)):l.post("http://localhost:3000/kitchenOrders",t).catch(a=>console.log(a.response.data.message))}).catch(s=>console.log(s.response.data.message)),e.splice(e.length-1,1),localStorage.setItem("kitchenDeleteTemp",JSON.stringify(e)),e.length==0&&localStorage.removeItem("kitchenDeleteTemp")}}});const D={computed:{...k(u,["newOrderLists","noKitchenDeleteTemp"])},methods:{...I(u,["getKitchenOrders","haveDeleteTemp","lineOrder","deleteFromKitchen","undo"])},mounted(){setInterval(()=>{this.getKitchenOrders()},3e3),setInterval(()=>{this.haveDeleteTemp()},500)}},w=e=>(v("data-v-2be46433"),e=e(),T(),e),y={class:"WaitingMeal mt-5"},K={class:"row wait-meal-scroll px-10"},L={class:"d-flex align-items-end mt-2 mb-4"},E=w(()=>n("h2",{class:"mb-0 me-6"},"廚房進度",-1)),N=["disabled"],x={class:"card rounded-0 bxShadow border-dark"},B={class:"card-header bg-white"},C={class:"card-body position-relative pb-10"},F=["onClick","id"],J=["onClick"];function M(e,t,s,r,a,c){return i(),d("div",y,[n("div",K,[n("div",L,[E,n("button",{type:"button",onClick:t[0]||(t[0]=(...o)=>e.undo&&e.undo(...o)),disabled:e.noKitchenDeleteTemp,class:"btn btn-sm btn-outline-danger mb-1 d-flex align-items-center",style:{"font-size":"11px"}}," 復原銷單 ",8,N)]),(i(!0),d(p,null,m(e.newOrderLists,o=>(i(),d("div",{class:"col-3 mb-5",key:o.tableId},[n("div",x,[n("div",B,g(o.tableId),1),n("div",C,[(i(!0),d(p,null,m(o.newOrders,(_,h)=>(i(),d("p",{class:"card-text mb-2 h6",key:h,onClick:()=>e.lineOrder(o.tableId,h),id:o.tableId+"_order_"+h},g(_.name),9,F))),128)),n("a",{href:"#",class:"btn btn-danger addToHistoryBTN",onClick:S(()=>e.deleteFromKitchen(o),["prevent"])},"銷單",8,J)])])]))),128))])])}const W=O(D,[["render",M],["__scopeId","data-v-2be46433"]]);export{W as default};
