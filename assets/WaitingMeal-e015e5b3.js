import{d as b,a as d,p as f,_ as O,m as v,b as k,o as i,c,e as o,F as p,f as m,t as g,l as I,i as S,j as T}from"./index-51c34748.js";const u=b("kitchenStore",{state:()=>({newOrderLists:[],noKitchenDeleteTemp:!0}),actions:{getKitchenOrders(){d.get("https://diriccardo-server.onrender.com/kitchenOrders").then(e=>{this.orderLists=e.data.sort((t,s)=>t.id>s.id),this.newOrderLists=this.changeOrder(this.orderLists)})},changeOrder(e){const{allProducts:t}=f();let s=[];return e.forEach(a=>{let n=[];a.orders.forEach(l=>{t.forEach(r=>{r.id===l&&n.push(r)}),a.newOrders=n}),s.push(a)}),s},lineOrder(e,t){document.getElementById(e+"_order_"+t).classList.toggle("delLine")},haveDeleteTemp(){localStorage.getItem("kitchenDeleteTemp")?this.noKitchenDeleteTemp=!1:this.noKitchenDeleteTemp=!0},deleteFromKitchen(e){let t=[];localStorage.getItem("kitchenDeleteTemp")&&(t=JSON.parse(localStorage.getItem("kitchenDeleteTemp"))),t.length>=10&&t.splice(0,1),t.push(e),localStorage.setItem("kitchenDeleteTemp",JSON.stringify(t)),d.delete("https://diriccardo-server.onrender.com/kitchenOrders/"+e.id).catch(s=>console.log(s.response.data.message))},async undo(){const e=JSON.parse(localStorage.getItem("kitchenDeleteTemp")),t={id:e[e.length-1].id,orders:e[e.length-1].orders,tableId:e[e.length-1].tableId};await d.get("https://diriccardo-server.onrender.com/kitchenOrders").then(s=>{let a=!1;return s.data.forEach(n=>{n.id==t.id&&(a=!0,n.orders.forEach(l=>{t.orders.push(l)}))}),a?d.patch("https://diriccardo-server.onrender.com/kitchenOrders/"+t.id,t).catch(n=>console.log(n.response.data.message)):d.post("https://diriccardo-server.onrender.com/kitchenOrders",t).catch(n=>console.log(n.response.data.message))}).catch(s=>console.log(s.response.data.message)),e.splice(e.length-1,1),localStorage.setItem("kitchenDeleteTemp",JSON.stringify(e)),e.length==0&&localStorage.removeItem("kitchenDeleteTemp")}}});const D={computed:{...v(u,["newOrderLists","noKitchenDeleteTemp"])},methods:{...k(u,["getKitchenOrders","haveDeleteTemp","lineOrder","deleteFromKitchen","undo"])},mounted(){setInterval(()=>{this.getKitchenOrders()},3e3),setInterval(()=>{this.haveDeleteTemp()},500)}},w=e=>(S("data-v-2be46433"),e=e(),T(),e),y={class:"WaitingMeal mt-5"},K={class:"row wait-meal-scroll px-10"},L={class:"d-flex align-items-end mt-2 mb-4"},E=w(()=>o("h2",{class:"mb-0 me-6"},"廚房進度",-1)),N=["disabled"],x={class:"card rounded-0 bxShadow border-dark"},B={class:"card-header bg-white"},C={class:"card-body position-relative pb-10"},F=["onClick","id"],J=["onClick"];function M(e,t,s,a,n,l){return i(),c("div",y,[o("div",K,[o("div",L,[E,o("button",{type:"button",onClick:t[0]||(t[0]=(...r)=>e.undo&&e.undo(...r)),disabled:e.noKitchenDeleteTemp,class:"btn btn-sm btn-outline-danger mb-1 d-flex align-items-center",style:{"font-size":"11px"}}," 復原銷單 ",8,N)]),(i(!0),c(p,null,m(e.newOrderLists,r=>(i(),c("div",{class:"col-3 mb-5",key:r.tableId},[o("div",x,[o("div",B,g(r.tableId),1),o("div",C,[(i(!0),c(p,null,m(r.newOrders,(_,h)=>(i(),c("p",{class:"card-text mb-2 h6",key:h,onClick:()=>e.lineOrder(r.tableId,h),id:r.tableId+"_order_"+h},g(_.name),9,F))),128)),o("a",{href:"#",class:"btn btn-danger addToHistoryBTN",onClick:I(()=>e.deleteFromKitchen(r),["prevent"])},"銷單",8,J)])])]))),128))])])}const W=O(D,[["render",M],["__scopeId","data-v-2be46433"]]);export{W as default};
